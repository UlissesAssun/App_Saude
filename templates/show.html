<!DOCTYPE html>
<!--
    PÃ¡gina de visualizaÃ§Ã£o de paciente por ID
    - Permite digitar/receber via querystring o ID do paciente
    - Ao enviar, chama JS (searchPatient) que reutiliza viewPatient para exibir dados
    - TambÃ©m tenta auto-buscar se a pÃ¡gina jÃ¡ recebeu ?id=XYZ
-->
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizar Paciente</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/show.css') }}">
    <script src="{{ url_for('static', filename='js/api.js') }}"></script>
</head>
<body>
    <!-- Navbar: links para outras telas -->
    <nav>
        <ul>
            <li><a href="{{ url_for('home') }}">ğŸ  InÃ­cio</a></li>
            <li><a href="{{ url_for('cadastrar') }}">ğŸ“ Cadastrar Paciente</a></li>
            <li><a href="{{ url_for('listar') }}">ğŸ“‹ Listar Pacientes</a></li>
            <li><a href="{{ url_for('visualizar') }}">ğŸ‘ï¸ Visualizar Paciente</a></li>
            <li><a href="{{ url_for('deletar') }}">ğŸ—‘ï¸ Deletar Paciente</a></li>
            <li><a href="{{ url_for('atualizar') }}">âœï¸ Atualizar Paciente</a></li>
        </ul>
    </nav>

    <!-- Container principal com formulÃ¡rio de busca por ID -->
    <div class="container">
        <div class="welcome-card">
            <h1>ğŸ‘ï¸ Visualizar Paciente</h1>
            <p>Digite o ID do paciente que deseja visualizar</p>
            
            <div class="form-container">
                <!-- O evento onsubmit chama a funÃ§Ã£o JS para buscar o paciente -->
                <form onsubmit="searchPatient(event)">
                    <div class="form-group">
                        <label for="id_paciente" class="form-label">ID do Paciente:</label>
                        <input type="number" id="id_paciente" name="id_paciente" class="form-input" required min ="0" required placeholder="Digite o ID" value="{{ patient_id if patient_id else '' }}">
                    </div>

                    <button type="submit" class="form-button">Buscar Paciente</button>
                </form>
            </div>
        </div>
    </div>
            <!-- Script para auto-executar a busca se houver ID na URL -->
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    try {
                        // se o campo id_paciente tiver valor, chama automaticamente a busca
                        var input = document.getElementById('id_paciente');
                        if (input && input.value && input.value.trim() !== '') {
                            // pequena espera para garantir que api.js esteja carregado
                            setTimeout(function () { try { window.viewPatient(input.value); } catch (e) { /* se api.js nÃ£o estiver disponÃ­vel, ignora */ } }, 50);
                        }
                    } catch (err) {
                        console.warn('Auto-fetch show.html:', err);
                    }
                });
            </script>
</body>
</html>
